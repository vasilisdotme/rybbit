# Caddyfile
{$DOMAIN_NAME} {
    # Enable compression
    encode zstd gzip

    # Special handling for import endpoint with custom size limit
    handle /api/import-site-data/* {
        request_body {
            max_size {$MAX_IMPORT_SIZE:0}
        }
        reverse_proxy backend:3001
    }

    # All other API endpoints with 10MB limit
    handle /api/* {
        request_body {
            max_size 10MB
        }
        reverse_proxy backend:3001
    }

    # Proxy all other requests to the client service
    handle {
        reverse_proxy client:3002
    }
}